 ###############################################
공지

플랫폼: 리눅스, vscode, C, React, php
-------------------------------------
일주일에 한번정도 깃허브 내용 머지하여 재배포할 예정 머지할때마다 알려드릴테니 브랜치 새로 파면됨.
푸시할때 최소한 컴파일 에러는 안나는거 확인하고 푸시하기! 머지하면 모두가 컴파일에러 나요.



-------------------------------------
진행내용 기록 부분에 깃허브 푸시할때마다 내용 기록해주시면됩니다. 
mysql.h 등 다운로드 해야했던 내용 있으면 어떤 내용 다운로드했는지 같이 기록해주세요
(apt-get ~~~~~) 혹은 구글링했던 링크 URL 등.

진행내용 기록 예시 

정민수
2022/09/21 채팅목록 탭시 상세채팅방으로 넘어가기, 길게눌렀을떄 다이얼로그 띄우기
2022/09/23 상세채팅방 시작. 텍스트 입력시 db에 넘어감. 아직 채팅내용을 db에서 불러오는건 미완성.
2022/09/28 채팅입력시 db에 저장.
2022/09/29 상세채팅방 완료. db내용 비동기적으로 불러오고 채팅시작시나 채팅입력시 맨아래로 스크롤기능 (채팅방기능 완료시 이에따라 추가수정필요)
2022/10/08 db구조 단순화작업



###############################################
대략적인 흐름과 todo list

1. db파트 
   1.1 db연결  // 완성
   1.2 db조회(3.2 에 활용)  // 완성
   1.3 db에 데이터 추가 (3.5 에 활용)//미완성

2. 캡처 파트
   2.1  pcap 연결 해서 캡처하기  	// 완성
   2.2  port번호 얻어내기 (3.1 에 활용)    // 완성
   2.3  ip주소 얻어내기 (3.2 에 활용) // 완성

3. 필터링파트
   3.1 포트번호가 80 or 443인지 확인   //완성
   3.2 목적지 ip가 db내 필터링 리스트에 존재하는지 확인 //완성
   3.3 criminal ip  api 연결 확인 //완성
   3.4 ip주소 질의하여 응답값 원하는 내용 얻어내기 //완성
//전체 응답내용 설명 링크 (https://www.criminalip.io/ko/developer/api/get-ip-malicious-info)
   3.5 악성ip 일경우 ip주소와 웹에서 활용 할 수 있도록 얻어낸 내용중 일부 db에 저장 (3.2 와 5.*에 활용) //미완성

4. 패킷조작
**현장전문가 쌤 강의 이후 코드 보고 구체화예정

5. 웹UI
   5.1 React와 php 연동 확인 //완성 
   5.2 악성ip감지로 우회된 사이트임을 공지 //미완성(4.16기준 진행중)
   5.3 비밀번호 입력하여 로그인기능(회원가입은계획에없음)//완성
   5.4 도메인 관리(추가,삭제)//미완성




###############################################
진행내용 기록

정예은

[0418_01] db파트부분에서 mysql.h header연결이 되지않아 수정
   1. header>include>mysql파일을 추가함 (mysql 라이브러리를 넣음)
      *다른 방법 : 프로젝트의 의존성으로 라이브러리를 관리하고 설치하는 방법이 더 좋다고 하여 추가하려고 했으나 
                  각팀원의 우분투에 mysql라이브러리를 설치해야하는 번거로움이 있으므로 위 방법을 선택
   2. mysql라이브러리 경로를 db.h(헤더파일)에 추가함.
   3. db.c를 db.h와 헤더로 연결
   4. tasks.json에 main.c 와 db.c가 동시에 컴파일될 수 있도록 추가함.
      -lmysqlclient 옵션은 컴파일할 때 mysqlclient 라이브러리를 링크하도록 추가.
      이 라이브러리를 사용하여 MySQL 데이터베이스와 상호 작용.


[0419_01] db.c mariadbConnect 함수에서 mariadb 연결 부분과 SELECT 쿼리 실행 부분을 분할하여 함수간의 역할 분리
   1. main에서 문자열 인자로 받아 IP 필터링 가능하게 수정

[0501_01] sql selectQuery부분에서 select ip를 할수있게 수정완료.



양호철
04-22
패킷캡처 진행중
포트 필터 조건 dst port 80 or dst port 443
04-24
pcap_loop 인자로 사용될 got_packet callback 함수
libpcap 기본 함수에 주석
04-27
pcap handle main으로
MAC IP TCP 구조체 변수 전역변수로
05-01
pcap_lookupdev()함수 pcap_findalldevs()함수로 교체
비교할 ip를 얻기 위해 pcap_loop()함수를 pcap_next_ex()함수로 교체

정민수

04-21 http get 형태의 전송을 위해서 json 형식의 파일 필요 -> json.h헤더파일 필요
sudo apt-get install libjson-c-dev 명령어로 설치함.(처음시작을위한 것) 헤더파일내에 추가해뒀으므로
일단은 설치할필요없음. 그러나 gcc 명령어시 -ljson-c 옵션 추가사용해야함.

curl 라이브러리를 활용하여 api 서버에 http get 요청 발송하고 표준출력에 응답 받아오는 것 확인. 
pcap에서 긁어온 ip를 넘겨받아 전달 및 긁어온 데이터를 메모리에 받아 C에서 처리가능하도록 기능추가해야함
gcc 명령어시 -lcurl 옵션 추가사용해야함.

04-22 메모리에 받아서 데이터 처리 가능하도록 수정. 사용 api 를 virustotal 에서 criminal ip로 교체

04-24 메모리에 받아온내용 파싱해서 악성유무 출력구현.

04-29 함수화 하고 주석추가.

04-30 파이썬 모듈 추가함 C에서 파이썬 모듈 사용하기 위해서 sudo apt-get install python3-dev 실행하여 python.h다운받아야함
      파이썬 모듈 컴파일을 위해서 gcc 명령시 -lpython3.10 옵션 추가해야함 

05-01 db와 1차머징함 유저명, 테이블 명 등 통일 하고 api,py호출과 연계함.

05-02 머징완료.. 그러나 패킷의 개수 다양하여 기존방식 즉 (목적지 ip 캡처하여 악성 질의 후 
브라우저 내리고 우리 사이트로 올리는 방식)에 변화 필요... 


